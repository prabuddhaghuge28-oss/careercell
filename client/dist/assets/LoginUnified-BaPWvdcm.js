import{u as C,r,j as e,b as k,B as E}from"./index-F5vbwB_e.js";import{L as P}from"./logo-N57qeR3r.js";import{C as R}from"./Toast-3WOWCnnS.js";import{i as F}from"./auth.utility-BSlGJMKu.js";import{B}from"./Button-yCakRxFg.js";import"./ThemeProvider-nWUV6F1R.js";import"./useTimeout-BGLe_eT-.js";import"./TransitionWrapper-BBSR4vEj.js";const x={student:"/student/dashboard",tpo_admin:"/tpo/dashboard",management_admin:"/management/dashboard"};function O(){document.title="CareerCell | Login";const d=C(),[g,w]=r.useState(!1),[v,m]=r.useState(!1),[b,c]=r.useState(""),[t,l]=r.useState({}),[u,y]=r.useState(!1);r.useEffect(()=>{if(F())try{const s=localStorage.getItem("token");if(s){const o=JSON.parse(atob(s.split(".")[1])).role||null;if(o&&x[o])return d(x[o])}}catch{}},[d]);const[a,f]=r.useState({email:"",password:"",role:"student"}),j=s=>{if(f({...a,[s.target.name]:s.target.value}),s.target.name==="email")return l({...t,email:""});if(s.target.name==="password")return l({...t,password:""})},N=async s=>{var p,o;if(s.preventDefault(),!a.email&&!a.password)return l({email:"Email Required!",password:"Password Required!"});if(!a.email)return l({email:"Email Required!"});if(!a.password)return l({password:"Password Required!"});w(!0);try{const n=await k.post(`${E}/user/login`,{email:a.email.trim(),password:a.password}),{token:h,role:i,isApproved:L}=n.data;localStorage.setItem("token",h),i&&i!==a.role&&(c(`Logged in as ${i}. Redirecting...`),m(!0)),i==="student"&&L===!1&&(c("Logged in. Your account is pending TPO approval â€” some features may be restricted."),m(!0));const S=x[i]||"/";d(S)}catch(n){const h=((o=(p=n==null?void 0:n.response)==null?void 0:p.data)==null?void 0:o.msg)||"Login failed!";c(h),m(!0),w(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(R,{show:v,onClose:()=>m(!1),message:b,delay:3e3,position:"bottom-end"}),e.jsxs("div",{className:"relative flex justify-center items-center min-h-screen bg-gradient-to-br from-primary-50 via-surface-soft to-primary-100",children:[e.jsxs("div",{className:"absolute -z-10 inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-20 -right-20 w-80 h-80 bg-primary-300/30 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-24 -left-16 w-96 h-96 bg-accent-300/30 rounded-full blur-3xl"})]}),e.jsxs("form",{className:"form-signin flex justify-center items-center flex-col gap-4 backdrop-blur-xl bg-white/70 border border-white/40 rounded-2xl p-8 md:p-10 shadow-soft w-[92%] sm:w-[80%] md:w-[500px]",onSubmit:N,children:[e.jsxs("div",{className:"flex justify-center items-center flex-col text-center",children:[e.jsx("img",{className:"mb-4 rounded-xl shadow w-24 h-24 md:w-28 md:h-28 cursor-pointer",src:`${P}`,alt:"Logo Image",onClick:()=>d("/")}),e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-800",children:"Unified Login"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Choose your role and sign in"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Login as"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"role",value:a.role,onChange:s=>f({...a,role:s.target.value}),"aria-label":"Select role","aria-haspopup":"listbox",className:"form-control ml-1 bg-white/90 focus:bg-white focus:ring-2 focus:ring-primary-300 rounded-md p-2 pr-10 appearance-none cursor-pointer",children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"tpo_admin",children:"TPO Admin"}),e.jsx("option",{value:"management_admin",children:"Management Admin"})]}),e.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-gray-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.25 8.29a.75.75 0 01-.02-1.06z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"inputEmail",className:"sr-only",children:"Email address"}),e.jsx("input",{type:"email",id:"inputEmail",className:"form-control ml-1 bg-white/80 focus:bg-white focus:ring-2 focus:ring-primary-300 rounded-md",placeholder:"Email address",autoFocus:!0,autoComplete:"email",name:"email",value:a.email,onChange:j}),e.jsx("div",{className:"text-red-500 ml-2 text-left",children:t==null?void 0:t.email})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("label",{htmlFor:"inputPassword",className:"sr-only",children:"Password"}),e.jsx("input",{type:u?"text":"password",id:"inputPassword",className:"form-control bg-white/80 focus:bg-white focus:ring-2 focus:ring-primary-300 rounded-md pr-10",placeholder:"Password",autoComplete:"current-password",name:"password",value:a.password,onChange:j}),e.jsx("button",{type:"button","aria-label":u?"Hide password":"Show password",onClick:()=>y(s=>!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-600 hover:text-gray-800 p-1",children:u?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 19c-4.97 0-9.19-3.11-10-7 1.53-4.95 6.17-8 10-8 1.67 0 3.23.36 4.65 1.02"}),e.jsx("path",{d:"M1 1l22 22"})]}),e.jsx("span",{className:"sr-only",children:"Hide password"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),e.jsx("span",{className:"sr-only",children:"Show password"})]})})]}),e.jsx("div",{className:"text-red-500 text-left ml-2",children:t==null?void 0:t.password})]}),e.jsxs("div",{className:"flex justify-between items-center w-full text-sm text-gray-600",children:[e.jsx("span",{}),e.jsx("span",{className:"cursor-pointer hover:text-primary-700",children:"Forgot password?"})]}),e.jsx("div",{className:"flex justify-center items-center flex-col w-full",children:e.jsx(B,{type:"submit",variant:"primary",disabled:g,className:"w-full py-2 md:py-2.5 rounded-md shadow hover:shadow-md transition-shadow",children:g?"Loading...":"Log In"})})]})]})]})}export{O as default};
