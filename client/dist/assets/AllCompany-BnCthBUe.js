import{u as O,a as R,r as o,j as t,b as h,B as x}from"./index-F5vbwB_e.js";import{T as q}from"./Table-Cvi54BG9.js";import{T as H,O as p,a as L}from"./TablePlaceholder-yL1ruwTr.js";import{M as G}from"./Modal-DXZjyk5v.js";import{C as K}from"./Toast-3WOWCnnS.js";import"./TransitionWrapper-BBSR4vEj.js";import"./ThemeProvider-nWUV6F1R.js";import"./hasClass-CHl0QHe7.js";import"./useTimeout-BGLe_eT-.js";import"./warning-BE2tzXYX.js";import"./Placeholder-sFQbI7v7.js";import"./Col-CGBuhqx3.js";import"./Button-yCakRxFg.js";function de(){document.title="CarrerCell | All Company";const u=O(),S=R(),[M,g]=o.useState(!0),[i,D]=o.useState([]),[T,A]=o.useState([]),[m,E]=o.useState({companyName:"",companyId:""}),[$,l]=o.useState(!1),[k,n]=o.useState(""),[_,f]=o.useState(!1),[j,y]=o.useState(""),B=async()=>{var e;try{const a=localStorage.getItem("token"),s=await h.get(`${x}/user/detail`,{headers:{Authorization:`Bearer ${a}`}});s!=null&&s.data&&y((e=s==null?void 0:s.data)==null?void 0:e.role)}catch(a){console.log("Account.jsx => ",a)}},b=async()=>{var e,a;try{const s=localStorage.getItem("token"),c=await h.get(`${x}/company/company-detail`,{headers:{Authorization:`Bearer ${s}`}});D(Array.isArray(c.data.companys)?c.data.companys:[]),g(!1)}catch(s){console.log("Error fetching jobs ",s),(a=(e=s==null?void 0:s.response)==null?void 0:e.data)!=null&&a.msg&&(n(s.response.data.msg),l(!0))}},P=(e,a)=>{E({companyId:a,companyName:e}),f(!0)},I=async e=>{var a,s,c,C,N,v;try{const r=localStorage.getItem("token"),d=await h.post(`${x}/company/delete-company`,{companyId:e},{headers:{Authorization:`Bearer ${r}`}});f(!1),b(),(a=d==null?void 0:d.data)!=null&&a.msg&&(n((s=d==null?void 0:d.data)==null?void 0:s.msg),l(!0)),g(!1)}catch(r){(C=(c=r==null?void 0:r.response)==null?void 0:c.data)!=null&&C.msg&&(n((v=(N=r==null?void 0:r.response)==null?void 0:N.data)==null?void 0:v.msg),l(!0)),console.log("Error deleting job ",r)}},J=async()=>{var e,a;try{const s=await h.get(`${x}/tpo/jobs`);A(Array.isArray(s.data.data)?s.data.data:[])}catch(s){console.log("Error fetching jobs ",s),(a=(e=s==null?void 0:s.response)==null?void 0:e.data)!=null&&a.msg&&(n(s.response.data.msg),l(!0))}},U=e=>t.jsx(L,{id:"button-tooltip",...e,children:"Delete Company"}),z=e=>t.jsx(L,{id:"button-tooltip",...e,children:"Edit Company"}),W=()=>f(!1),{showToastPass:w,toastMessagePass:F}=S.state||{showToastPass:!1,toastMessagePass:""};return o.useEffect(()=>{w&&(n(F),l(w),u(".",{replace:!0,state:{}})),B(),b(),J()},[]),t.jsx(t.Fragment,{children:t.jsxs(t.Fragment,{children:[t.jsx(K,{show:$,onClose:()=>l(!1),message:k,delay:3e3,position:"bottom-end"}),t.jsx("div",{className:"",children:M?t.jsx(H,{}):t.jsxs(q,{striped:!0,bordered:!0,hover:!0,className:"bg-white my-6 rounded-lg shadow w-full text-base max-sm:text-sm max-sm:my-3",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{style:{width:"7%"},children:"Sr. No."}),t.jsx("th",{style:{width:"18%"},children:t.jsx("b",{children:"Company Name"})}),t.jsx("th",{style:{width:"15%"},children:"Company Website"}),t.jsx("th",{style:{width:"15%"},children:"Company Location"}),t.jsx("th",{style:{width:"17%"},children:"Company Difficulty Level"}),t.jsx("th",{style:{width:"13%"},children:"No. of Jobs Posted"}),t.jsx("th",{style:{width:"15%"},children:"Action"})]})}),t.jsx("tbody",{children:(i==null?void 0:i.length)>0?i==null?void 0:i.map((e,a)=>t.jsxs("tr",{children:[t.jsx("td",{children:a+1}),t.jsx("td",{children:t.jsx("b",{children:e==null?void 0:e.companyName})}),t.jsx("td",{children:t.jsx("a",{href:e==null?void 0:e.companyWebsite,target:"_blank",className:"text-blue-500 no-underline",rel:"noopener noreferrer",children:e==null?void 0:e.companyWebsite})}),t.jsx("td",{children:e==null?void 0:e.companyLocation}),t.jsxs("td",{children:[(e==null?void 0:e.companyDifficulty)==="Easy"&&t.jsx("span",{className:"bg-green-500 text-white px-2 py-1 rounded",children:e==null?void 0:e.companyDifficulty}),(e==null?void 0:e.companyDifficulty)==="Moderate"&&t.jsx("span",{className:"bg-orange-500 text-white px-2 py-1 rounded",children:e==null?void 0:e.companyDifficulty}),(e==null?void 0:e.companyDifficulty)==="Hard"&&t.jsx("span",{className:"bg-red-500 text-white px-2 py-1 rounded",children:e==null?void 0:e.companyDifficulty})]}),t.jsx("td",{children:T.filter(s=>(s==null?void 0:s.company)==(e==null?void 0:e._id)).length}),t.jsx("td",{children:t.jsxs("div",{className:"flex justify-around items-center max-sm:flex-col max-sm:gap-1",children:[t.jsx("div",{className:"px-0.5",children:t.jsx(p,{placement:"top",delay:{show:250,hide:400},overlay:z,children:t.jsx("i",{className:"fa-regular fa-pen-to-square text-2xl max-sm:text-lg cursor-pointer transition-colors duration-200 ease-in-out hover:text-blue-500",onClick:()=>{j==="tpo_admin"?u(`../tpo/add-company/${e._id}`):j==="management_admin"&&u(`../management/add-company/${e._id}`)},onMouseEnter:s=>{s.target.classList.add("fa-solid"),s.target.classList.remove("fa-regular")},onMouseLeave:s=>{s.target.classList.add("fa-regular"),s.target.classList.remove("fa-solid")}})})}),t.jsx("div",{className:"px-0.5",children:t.jsx(p,{placement:"top",delay:{show:250,hide:400},overlay:U,children:t.jsx("i",{className:"fa-regular fa-trash-can text-2xl max-sm:text-lg cursor-pointer transition-colors duration-200 ease-in-out hover:text-red-500",onClick:()=>P(e==null?void 0:e.companyName,e==null?void 0:e._id),onMouseEnter:s=>{s.target.classList.add("fa-solid"),s.target.classList.remove("fa-regular")},onMouseLeave:s=>{s.target.classList.add("fa-regular"),s.target.classList.remove("fa-solid")}})})})]})})]},e==null?void 0:e._id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"7",children:"No Jobs found"})})})]})}),t.jsx(G,{show:_,close:W,header:"Confirmation",body:`Do you want to delete company ${m.companyName}?`,btn:"Delete",confirmAction:()=>I(m.companyId)})]})})}export{de as default};
